<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BookGlow - Reading List Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #8b5cf6;
            --primary-dark: #7c3aed;
            --primary-light: rgba(139, 92, 246, 0.1);
            --bg: #0f0f14;
            --bg-gradient: linear-gradient(135deg, #0f0f14 0%, #1a1a2e 100%);
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --border: rgba(255, 255, 255, 0.08);
            --text: #ffffff;
            --text-muted: rgba(255, 255, 255, 0.6);
            --text-dim: rgba(255, 255, 255, 0.4);
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-glow: 0 0 20px rgba(139, 92, 246, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-gradient);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 80px;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, #ec4899 100%);
            padding: 2rem 1rem 3rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .app-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .app-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .main-content {
            padding: 1rem;
            max-width: 100vw;
            animation: fadeInUp 0.5s ease-out;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-glow);
            border-color: var(--primary);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(139, 92, 246, 0.5);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .book-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 25px;
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(15px);
        }

        .book-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-glow);
            border-color: var(--primary);
        }

        .book-header {
            display: flex;
            padding: 1.5rem;
            align-items: flex-start;
            gap: 1rem;
        }

        .book-cover {
            width: 80px;
            height: 120px;
            background: linear-gradient(135deg, var(--primary), #ec4899);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
            box-shadow: 0 8px 16px rgba(139, 92, 246, 0.3);
            position: relative;
            overflow: hidden;
        }

        .book-cover::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 15%;
            width: 3px;
            height: 80%;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
        }

        .book-info {
            flex: 1;
            min-width: 0;
        }

        .book-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            line-height: 1.3;
        }

        .book-author {
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
        }

        .book-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-reading {
            background: rgba(139, 92, 246, 0.2);
            color: var(--primary);
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-wishlist {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .book-progress {
            padding: 0 1.5rem 1.5rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), #ec4899);
            border-radius: 10px;
            transition: width 0.8s ease;
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.5);
        }

        .progress-text {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
        }

        .rating {
            display: flex;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .star {
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
        }

        .star.filled {
            color: #ffd700;
        }

        .star.empty {
            color: rgba(255, 255, 255, 0.2);
        }

        .star:hover {
            transform: scale(1.2);
        }

        .fab {
            position: fixed;
            bottom: 90px;
            right: 1.5rem;
            width: 64px;
            height: 64px;
            background: linear-gradient(135deg, var(--primary), #ec4899);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: var(--shadow-glow);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .fab:hover {
            transform: scale(1.1);
        }

        .fab:active {
            transform: scale(0.95);
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 15, 20, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            padding: 1rem 0 0.5rem;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            padding: 0.5rem;
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            border-radius: 15px;
            min-width: 60px;
        }

        .nav-item.active {
            color: var(--primary);
            background: rgba(139, 92, 246, 0.1);
            transform: translateY(-2px);
        }

        .nav-icon {
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .nav-item.active .nav-icon {
            transform: scale(1.1);
            filter: drop-shadow(0 0 10px rgba(139, 92, 246, 0.8));
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: flex-end;
        }

        .modal-content {
            background: var(--bg);
            width: 100%;
            max-height: 90vh;
            border-radius: 25px 25px 0 0;
            padding: 2rem;
            animation: slideUp 0.3s ease;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 15px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
            transform: translateY(-2px);
        }

        .form-select {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 15px;
            background: var(--card-bg);
            color: var(--text);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), #ec4899);
            color: white;
            box-shadow: var(--shadow-glow);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: transparent;
            color: var(--text-muted);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .modal-buttons .btn {
            flex: 1;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--text-muted);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--text);
        }

        .chart-container {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(10px);
        }

        .chart-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .reading-streak {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: white;
            padding: 1rem;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .reading-streak::before {
            content: 'üî•';
            font-size: 2rem;
            position: absolute;
            top: 0.5rem;
            right: 1rem;
            animation: flicker 2s ease-in-out infinite alternate;
        }

        @keyframes flicker {
            0% { transform: scale(1) rotate(-5deg); }
            100% { transform: scale(1.1) rotate(5deg); }
        }

        .streak-text {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .book-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .action-btn {
            padding: 0.5rem;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .action-btn:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        @media (min-width: 768px) {
            .main-content {
                max-width: 600px;
                margin: 0 auto;
            }
            
            .modal-content {
                max-width: 500px;
                margin: auto;
                border-radius: 25px;
            }
        }

        .notification {
            position: fixed;
            top: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 1rem 2rem;
            border-radius: 15px;
            font-weight: 600;
            z-index: 2000;
            animation: slideDown 0.3s ease;
            box-shadow: var(--shadow);
        }

        @keyframes slideDown {
            from { transform: translateX(-50%) translateY(-100%); }
            to { transform: translateX(-50%) translateY(0); }
        }

        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .filter-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 2px solid var(--border);
            border-radius: 20px;
            color: var(--text-muted);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .filter-tab.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .filter-tab:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1 class="app-title">üìö BookGlow</h1>
            <p class="app-subtitle">Track your reading journey with style</p>
        </div>
    </div>

    <div class="main-content">
        <!-- Dashboard View -->
        <div id="dashboard" class="view active">
            <div class="reading-streak">
                <div class="streak-text">
                    <span id="streak-days">0</span> day reading streak!
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-books">0</div>
                    <div class="stat-label">Total Books</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="completed-books">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="currently-reading">0</div>
                    <div class="stat-label">Reading</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pages-read">0</div>
                    <div class="stat-label">Pages Read</div>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìä Reading Progress</h3>
                <canvas id="progressChart" width="400" height="200"></canvas>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">‚≠ê Rating Distribution</h3>
                <canvas id="ratingsChart" width="400" height="200"></canvas>
            </div>
        </div>

        <!-- Library View -->
        <div id="library" class="view">
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">All Books</button>
                <button class="filter-tab" data-filter="reading">Currently Reading</button>
                <button class="filter-tab" data-filter="completed">Completed</button>
                <button class="filter-tab" data-filter="wishlist">Wishlist</button>
            </div>

            <div id="books-container">
                <div class="empty-state">
                    <div class="empty-icon">üìñ</div>
                    <h3 class="empty-title">No books yet</h3>
                    <p>Tap the ‚ûï button to add your first book!</p>
                </div>
            </div>
        </div>

        <!-- Statistics View -->
        <div id="statistics" class="view">
            <div class="chart-container">
                <h3 class="chart-title">üìà Monthly Reading</h3>
                <canvas id="monthlyChart" width="400" height="200"></canvas>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="avg-rating">0.0</div>
                    <div class="stat-label">Avg Rating</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="total-pages">0</div>
                    <div class="stat-label">Total Pages</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="books-this-year">0</div>
                    <div class="stat-label">This Year</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="favorite-genre">-</div>
                    <div class="stat-label">Top Genre</div>
                </div>
            </div>

            <div class="chart-container">
                <h3 class="chart-title">üìö Genre Distribution</h3>
                <canvas id="genreChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Add Book FAB -->
    <button class="fab" id="add-book-btn">‚ûï</button>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="#dashboard" class="nav-item active">
            <div class="nav-icon">üìä</div>
            <div>Dashboard</div>
        </a>
        <a href="#library" class="nav-item">
            <div class="nav-icon">üìö</div>
            <div>Library</div>
        </a>
        <a href="#statistics" class="nav-item">
            <div class="nav-icon">üìà</div>
            <div>Stats</div>
        </a>
    </nav>

    <!-- Add Book Modal -->
    <div id="add-book-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 2rem; color: var(--primary);">üìñ Add New Book</h2>
            
            <div class="form-group">
                <label class="form-label">Title</label>
                <input type="text" id="book-title" class="form-input" placeholder="Enter book title">
            </div>

            <div class="form-group">
                <label class="form-label">Author</label>
                <input type="text" id="book-author" class="form-input" placeholder="Enter author name">
            </div>

            <div class="form-group">
                <label class="form-label">Genre</label>
                <select id="book-genre" class="form-select">
                    <option value="">Select genre</option>
                    <option value="Fiction">Fiction</option>
                    <option value="Non-Fiction">Non-Fiction</option>
                    <option value="Mystery">Mystery</option>
                    <option value="Romance">Romance</option>
                    <option value="Sci-Fi">Sci-Fi</option>
                    <option value="Fantasy">Fantasy</option>
                    <option value="Biography">Biography</option>
                    <option value="History">History</option>
                    <option value="Self-Help">Self-Help</option>
                    <option value="Business">Business</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Total Pages</label>
                <input type="number" id="book-pages" class="form-input" placeholder="Number of pages">
            </div>

            <div class="form-group">
                <label class="form-label">Status</label>
                <select id="book-status" class="form-select">
                    <option value="wishlist">Wishlist</option>
                    <option value="reading">Currently Reading</option>
                    <option value="completed">Completed</option>
                </select>
            </div>

            <div class="form-group" id="current-page-group" style="display: none;">
                <label class="form-label">Current Page</label>
                <input type="number" id="book-current-page" class="form-input" placeholder="Current page">
            </div>

            <div class="form-group" id="rating-group" style="display: none;">
                <label class="form-label">Rating</label>
                <div class="rating" id="book-rating">
                    <span class="star empty" data-rating="1">‚≠ê</span>
                    <span class="star empty" data-rating="2">‚≠ê</span>
                    <span class="star empty" data-rating="3">‚≠ê</span>
                    <span class="star empty" data-rating="4">‚≠ê</span>
                    <span class="star empty" data-rating="5">‚≠ê</span>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" id="cancel-btn">Cancel</button>
                <button class="btn btn-primary" id="save-book-btn">Save Book</button>
            </div>
        </div>
    </div>

    <!-- Edit Book Modal -->
    <div id="edit-book-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 2rem; color: var(--primary);">‚úèÔ∏è Edit Book</h2>
            
            <div class="form-group">
                <label class="form-label">Status</label>
                <select id="edit-book-status" class="form-select">
                    <option value="wishlist">Wishlist</option>
                    <option value="reading">Currently Reading</option>
                    <option value="completed">Completed</option>
                </select>
            </div>

            <div class="form-group" id="edit-current-page-group">
                <label class="form-label">Current Page</label>
                <input type="number" id="edit-book-current-page" class="form-input">
            </div>

            <div class="form-group" id="edit-rating-group" style="display: none;">
                <label class="form-label">Rating</label>
                <div class="rating" id="edit-book-rating">
                    <span class="star empty" data-rating="1">‚≠ê</span>
                    <span class="star empty" data-rating="2">‚≠ê</span>
                    <span class="star empty" data-rating="3">‚≠ê</span>
                    <span class="star empty" data-rating="4">‚≠ê</span>
                    <span class="star empty" data-rating="5">‚≠ê</span>
                </div>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" id="delete-book-btn" style="background: var(--danger);">Delete</button>
                <button class="btn btn-secondary" id="cancel-edit-btn">Cancel</button>
                <button class="btn btn-primary" id="save-edit-btn">Save Changes</button>
            </div>
        </div>
    </div>

    <script>
        // App State
        let books = JSON.parse(localStorage.getItem('bookglow-books')) || [];
        let currentFilter = 'all';
        let currentEditingBook = null;
        let currentRating = 0;
        let editRating = 0;

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            initializeNavigation();
            initializeModals();
            initializeRatings();
            updateDashboard();
            renderBooks();
            updateStatistics();
        });

        // Navigation
        function initializeNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            const views = document.querySelectorAll('.view');

            navItems.forEach(item => {
                item.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetView = item.getAttribute('href').substring(1);
                    
                    // Update active nav item
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Update active view
                    views.forEach(view => view.classList.remove('active'));
                    document.getElementById(targetView).classList.add('active');
                    
                    // Update charts if needed
                    if (targetView === 'dashboard') {
                        updateDashboard();
                    } else if (targetView === 'statistics') {
                        updateStatistics();
                    }
                });
            });

            // Filter tabs
            const filterTabs = document.querySelectorAll('.filter-tab');
            filterTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    filterTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentFilter = tab.getAttribute('data-filter');
                    renderBooks();
                });
            });
        }

        // Modal Management
        function initializeModals() {
            const addBtn = document.getElementById('add-book-btn');
            const addModal = document.getElementById('add-book-modal');
            const editModal = document.getElementById('edit-book-modal');
            const cancelBtn = document.getElementById('cancel-btn');
            const cancelEditBtn = document.getElementById('cancel-edit-btn');
            const saveBtn = document.getElementById('save-book-btn');
            const saveEditBtn = document.getElementById('save-edit-btn');
            const deleteBtn = document.getElementById('delete-book-btn');
            const statusSelect = document.getElementById('book-status');
            const editStatusSelect = document.getElementById('edit-book-status');

            addBtn.addEventListener('click', () => {
                addModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            });

            cancelBtn.addEventListener('click', closeAddModal);
            cancelEditBtn.addEventListener('click', closeEditModal);

            function closeAddModal() {
                addModal.classList.remove('active');
                document.body.style.overflow = 'auto';
                resetAddForm();
            }

            function closeEditModal() {
                editModal.classList.remove('active');
                document.body.style.overflow = 'auto';
                currentEditingBook = null;
                editRating = 0;
            }

            // Close on background click
            addModal.addEventListener('click', (e) => {
                if (e.target === addModal) closeAddModal();
            });

            editModal.addEventListener('click', (e) => {
                if (e.target === editModal) closeEditModal();
            });

            // Status change handlers
            statusSelect.addEventListener('change', updateFormVisibility);
            editStatusSelect.addEventListener('change', updateEditFormVisibility);

            // Save handlers
            saveBtn.addEventListener('click', saveBook);
            saveEditBtn.addEventListener('click', saveBookEdit);
            deleteBtn.addEventListener('click', deleteBook);
        }

        function updateFormVisibility() {
            const status = document.getElementById('book-status').value;
            const currentPageGroup = document.getElementById('current-page-group');
            const ratingGroup = document.getElementById('rating-group');

            if (status === 'reading') {
                currentPageGroup.style.display = 'block';
                ratingGroup.style.display = 'none';
            } else if (status === 'completed') {
                currentPageGroup.style.display = 'block';
                ratingGroup.style.display = 'block';
            } else {
                currentPageGroup.style.display = 'none';
                ratingGroup.style.display = 'none';
            }
        }

        function updateEditFormVisibility() {
            const status = document.getElementById('edit-book-status').value;
            const currentPageGroup = document.getElementById('edit-current-page-group');
            const ratingGroup = document.getElementById('edit-rating-group');

            if (status === 'reading' || status === 'completed') {
                currentPageGroup.style.display = 'block';
            } else {
                currentPageGroup.style.display = 'none';
            }

            if (status === 'completed') {
                ratingGroup.style.display = 'block';
            } else {
                ratingGroup.style.display = 'none';
            }
        }

        // Rating System
        function initializeRatings() {
            const ratingStars = document.querySelectorAll('#book-rating .star');
            const editRatingStars = document.querySelectorAll('#edit-book-rating .star');

            ratingStars.forEach(star => {
                star.addEventListener('click', () => {
                    currentRating = parseInt(star.getAttribute('data-rating'));
                    updateStars(ratingStars, currentRating);
                });
            });

            editRatingStars.forEach(star => {
                star.addEventListener('click', () => {
                    editRating = parseInt(star.getAttribute('data-rating'));
                    updateStars(editRatingStars, editRating);
                });
            });
        }

        function updateStars(stars, rating) {
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('empty');
                    star.classList.add('filled');
                } else {
                    star.classList.remove('filled');
                    star.classList.add('empty');
                }
            });
        }

        // Book Management
        function saveBook() {
            const title = document.getElementById('book-title').value.trim();
            const author = document.getElementById('book-author').value.trim();
            const genre = document.getElementById('book-genre').value;
            const pages = parseInt(document.getElementById('book-pages').value) || 0;
            const status = document.getElementById('book-status').value;
            const currentPage = parseInt(document.getElementById('book-current-page').value) || 0;

            if (!title || !author) {
                showNotification('Please fill in title and author', 'error');
                return;
            }

            const book = {
                id: Date.now(),
                title,
                author,
                genre,
                pages,
                status,
                currentPage: status === 'wishlist' ? 0 : currentPage,
                rating: status === 'completed' ? currentRating : 0,
                dateAdded: new Date(),
                dateCompleted: status === 'completed' ? new Date() : null
            };

            books.push(book);
            localStorage.setItem('bookglow-books', JSON.stringify(books));
            
            showNotification('Book added successfully! üìö');
            document.getElementById('add-book-modal').classList.remove('active');
            document.body.style.overflow = 'auto';
            resetAddForm();
            
            updateDashboard();
            renderBooks();
            updateStatistics();
        }

        function editBook(bookId) {
            currentEditingBook = books.find(book => book.id === bookId);
            if (!currentEditingBook) return;

            document.getElementById('edit-book-status').value = currentEditingBook.status;
            document.getElementById('edit-book-current-page').value = currentEditingBook.currentPage || 0;
            
            editRating = currentEditingBook.rating || 0;
            updateStars(document.querySelectorAll('#edit-book-rating .star'), editRating);
            
            updateEditFormVisibility();
            
            document.getElementById('edit-book-modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function saveBookEdit() {
            if (!currentEditingBook) return;

            const newStatus = document.getElementById('edit-book-status').value;
            const newCurrentPage = parseInt(document.getElementById('edit-book-current-page').value) || 0;

            currentEditingBook.status = newStatus;
            currentEditingBook.currentPage = newCurrentPage;
            
            if (newStatus === 'completed') {
                currentEditingBook.rating = editRating;
                currentEditingBook.dateCompleted = new Date();
                currentEditingBook.currentPage = currentEditingBook.pages;
            } else if (newStatus === 'wishlist') {
                currentEditingBook.currentPage = 0;
                currentEditingBook.rating = 0;
                currentEditingBook.dateCompleted = null;
            } else {
                currentEditingBook.rating = 0;
                currentEditingBook.dateCompleted = null;
            }

            localStorage.setItem('bookglow-books', JSON.stringify(books));
            
            showNotification('Book updated successfully! ‚úÖ');
            document.getElementById('edit-book-modal').classList.remove('active');
            document.body.style.overflow = 'auto';
            
            updateDashboard();
            renderBooks();
            updateStatistics();
        }

        function deleteBook() {
            if (!currentEditingBook) return;

            if (confirm('Are you sure you want to delete this book?')) {
                books = books.filter(book => book.id !== currentEditingBook.id);
                localStorage.setItem('bookglow-books', JSON.stringify(books));
                
                showNotification('Book deleted successfully! üóëÔ∏è');
                document.getElementById('edit-book-modal').classList.remove('active');
                document.body.style.overflow = 'auto';
                
                updateDashboard();
                renderBooks();
                updateStatistics();
            }
        }

        function resetAddForm() {
            document.getElementById('book-title').value = '';
            document.getElementById('book-author').value = '';
            document.getElementById('book-genre').value = '';
            document.getElementById('book-pages').value = '';
            document.getElementById('book-status').value = 'wishlist';
            document.getElementById('book-current-page').value = '';
            
            currentRating = 0;
            updateStars(document.querySelectorAll('#book-rating .star'), 0);
            updateFormVisibility();
        }

        // Render Books
        function renderBooks() {
            const container = document.getElementById('books-container');
            const filteredBooks = books.filter(book => {
                if (currentFilter === 'all') return true;
                return book.status === currentFilter;
            });

            if (filteredBooks.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üìñ</div>
                        <h3 class="empty-title">No books found</h3>
                        <p>Try adjusting your filter or add a new book!</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredBooks.map(book => {
                const progress = book.pages > 0 ? (book.currentPage / book.pages) * 100 : 0;
                const statusClass = `status-${book.status}`;
                
                return `
                    <div class="book-card">
                        <div class="book-header">
                            <div class="book-cover">üìö</div>
                            <div class="book-info">
                                <h3 class="book-title">${book.title}</h3>
                                <p class="book-author">by ${book.author}</p>
                                <div class="book-status ${statusClass}">
                                    ${book.status === 'reading' ? 'Currently Reading' : 
                                      book.status === 'completed' ? 'Completed' : 'Wishlist'}
                                </div>
                                ${book.rating > 0 ? `
                                    <div class="rating">
                                        ${'‚≠ê'.repeat(book.rating)}
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        ${(book.status === 'reading' || book.status === 'completed') && book.pages > 0 ? `
                            <div class="book-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: ${progress}%"></div>
                                </div>
                                <div class="progress-text">
                                    <span>${book.currentPage} / ${book.pages} pages</span>
                                    <span>${Math.round(progress)}%</span>
                                </div>
                            </div>
                        ` : ''}
                        <div class="book-actions">
                            <button class="action-btn" onclick="editBook(${book.id})">‚úèÔ∏è Edit</button>
                            ${book.status === 'reading' ? `
                                <button class="action-btn" onclick="quickUpdateProgress(${book.id})">üìñ Update Progress</button>
                            ` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function quickUpdateProgress(bookId) {
            const book = books.find(b => b.id === bookId);
            if (!book) return;
            
            const newPage = prompt(`Update progress for "${book.title}"\nCurrent page: ${book.currentPage}\nTotal pages: ${book.pages}\n\nEnter new page number:`, book.currentPage);
            
            if (newPage !== null && !isNaN(newPage) && newPage >= 0) {
                const pageNum = parseInt(newPage);
                book.currentPage = Math.min(pageNum, book.pages);
                
                if (book.currentPage >= book.pages) {
                    book.status = 'completed';
                    book.dateCompleted = new Date();
                }
                
                localStorage.setItem('bookglow-books', JSON.stringify(books));
                showNotification('Progress updated! üìñ');
                updateDashboard();
                renderBooks();
                updateStatistics();
            }
        }

        // Dashboard Updates
        function updateDashboard() {
            const totalBooks = books.length;
            const completedBooks = books.filter(book => book.status === 'completed').length;
            const currentlyReading = books.filter(book => book.status === 'reading').length;
            const totalPages = books.filter(book => book.status === 'completed').reduce((sum, book) => sum + book.pages, 0);
            
            document.getElementById('total-books').textContent = totalBooks;
            document.getElementById('completed-books').textContent = completedBooks;
            document.getElementById('currently-reading').textContent = currentlyReading;
            document.getElementById('pages-read').textContent = totalPages.toLocaleString();

            // Update streak
            updateReadingStreak();
            
            // Update charts
            updateProgressChart();
            updateRatingsChart();
        }

        function updateReadingStreak() {
            const completedBooks = books.filter(book => book.status === 'completed' && book.dateCompleted);
            const streak = calculateReadingStreak(completedBooks);
            document.getElementById('streak-days').textContent = streak;
        }

        function calculateReadingStreak(completedBooks) {
            if (completedBooks.length === 0) return 0;
            
            const sortedBooks = completedBooks.sort((a, b) => new Date(b.dateCompleted) - new Date(a.dateCompleted));
            const today = new Date();
            const msPerDay = 24 * 60 * 60 * 1000;
            
            let streak = 0;
            let currentDate = today;
            
            for (const book of sortedBooks) {
                const bookDate = new Date(book.dateCompleted);
                const daysDiff = Math.floor((currentDate - bookDate) / msPerDay);
                
                if (daysDiff <= 7) { // Within a week
                    streak++;
                    currentDate = bookDate;
                } else {
                    break;
                }
            }
            
            return streak;
        }

        function updateProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            const readingBooks = books.filter(book => book.status === 'reading' && book.pages > 0);
            
            if (readingBooks.length === 0) {
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                ctx.fillStyle = 'rgba(255,255,255,0.6)';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('No books currently being read', ctx.canvas.width/2, ctx.canvas.height/2);
                return;
            }

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: readingBooks.map(book => book.title.length > 20 ? book.title.substring(0, 20) + '...' : book.title),
                    datasets: [{
                        label: 'Progress %',
                        data: readingBooks.map(book => (book.currentPage / book.pages * 100).toFixed(1)),
                        backgroundColor: 'rgba(139, 92, 246, 0.8)',
                        borderColor: '#8b5cf6',
                        borderWidth: 2,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'rgba(255,255,255,0.8)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'rgba(255,255,255,0.8)'
                            }
                        }
                    }
                }
            });
        }

        function updateRatingsChart() {
            const ctx = document.getElementById('ratingsChart').getContext('2d');
            const ratedBooks = books.filter(book => book.rating > 0);
            
            if (ratedBooks.length === 0) {
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                ctx.fillStyle = 'rgba(255,255,255,0.6)';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('No rated books yet', ctx.canvas.width/2, ctx.canvas.height/2);
                return;
            }

            const ratingCounts = [0, 0, 0, 0, 0];
            ratedBooks.forEach(book => {
                ratingCounts[book.rating - 1]++;
            });

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['1‚≠ê', '2‚≠ê', '3‚≠ê', '4‚≠ê', '5‚≠ê'],
                    datasets: [{
                        data: ratingCounts,
                        backgroundColor: [
                            '#ef4444',
                            '#f59e0b',
                            '#eab308',
                            '#22c55e',
                            '#8b5cf6'
                        ],
                        borderWidth: 2,
                        borderColor: '#0f0f14'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'rgba(255,255,255,0.8)',
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        // Statistics
        function updateStatistics() {
            const completedBooks = books.filter(book => book.status === 'completed');
            const totalPages = completedBooks.reduce((sum, book) => sum + book.pages, 0);
            const avgRating = completedBooks.length > 0 ? 
                (completedBooks.reduce((sum, book) => sum + (book.rating || 0), 0) / completedBooks.length).toFixed(1) : '0.0';
            
            const currentYear = new Date().getFullYear();
            const booksThisYear = completedBooks.filter(book => 
                new Date(book.dateCompleted).getFullYear() === currentYear
            ).length;
            
            const genres = books.reduce((acc, book) => {
                if (book.genre) {
                    acc[book.genre] = (acc[book.genre] || 0) + 1;
                }
                return acc;
            }, {});
            
            const favoriteGenre = Object.keys(genres).length > 0 ? 
                Object.keys(genres).reduce((a, b) => genres[a] > genres[b] ? a : b) : '-';

            document.getElementById('avg-rating').textContent = avgRating;
            document.getElementById('total-pages').textContent = totalPages.toLocaleString();
            document.getElementById('books-this-year').textContent = booksThisYear;
            document.getElementById('favorite-genre').textContent = favoriteGenre;

            updateMonthlyChart();
            updateGenreChart();
        }

        function updateMonthlyChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const monthlyData = new Array(12).fill(0);
            
            const currentYear = new Date().getFullYear();
            books.filter(book => book.status === 'completed' && book.dateCompleted)
                 .forEach(book => {
                     const date = new Date(book.dateCompleted);
                     if (date.getFullYear() === currentYear) {
                         monthlyData[date.getMonth()]++;
                     }
                 });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: monthNames,
                    datasets: [{
                        label: 'Books Completed',
                        data: monthlyData,
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#8b5cf6',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 6
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'rgba(255,255,255,0.8)'
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'rgba(255,255,255,0.8)'
                            }
                        }
                    }
                }
            });
        }

        function updateGenreChart() {
            const ctx = document.getElementById('genreChart').getContext('2d');
            const genres = books.reduce((acc, book) => {
                if (book.genre) {
                    acc[book.genre] = (acc[book.genre] || 0) + 1;
                }
                return acc;
            }, {});

            if (Object.keys(genres).length === 0) {
                ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                ctx.fillStyle = 'rgba(255,255,255,0.6)';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('No genre data available', ctx.canvas.width/2, ctx.canvas.height/2);
                return;
            }

            const colors = ['#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#ef4444', '#06b6d4', '#8b5cf6', '#f97316'];

            new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: Object.keys(genres),
                    datasets: [{
                        data: Object.values(genres),
                        backgroundColor: colors.slice(0, Object.keys(genres).length),
                        borderWidth: 2,
                        borderColor: '#0f0f14'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'rgba(255,255,255,0.8)',
                                padding: 15
                            }
                        }
                    },
                    scales: {
                        r: {
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'rgba(255,255,255,0.6)',
                                backdropColor: 'transparent'
                            }
                        }
                    }
                }
            });
        }

        // Utilities
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            if (type === 'error') {
                notification.style.background = 'var(--danger)';
            }
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideDown 0.3s ease reverse';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html>